Add-Type -TypeDefinition @"
using System;
using System.Runtime.InteropServices;
public class Mouse {
    [DllImport("user32.dll")] public static extern short GetAsyncKeyState(int vKey);
    [DllImport("user32.dll")] public static extern void mouse_event(int dwFlags, int dx, int dy, int dwData, int dwExtraInfo);
}
"@

Write-Host "--- HERA CLICKER: MODO BUCLE ---" -ForegroundColor Cyan
Write-Host "1. Abre Minecraft (asegúrate que NO esté en pantalla completa total)."
Write-Host "2. Mantén presionado Clic Izquierdo para Combat o Derecho para Bridge."
Write-Host "3. Para cerrar, cierra esta ventana de PowerShell."

$L_CPS = 16  # Ajusta aquí los CPS de Combate
$R_CPS = 22  # Ajusta aquí los CPS de Bridge

$lDelay = 1000 / $L_CPS
$rDelay = 1000 / $R_CPS

$lLast = 0
$rLast = 0
$sw = [System.Diagnostics.Stopwatch]::StartNew()

while($true) {
    $now = $sw.ElapsedMilliseconds

    # DETECTAR CLIC IZQUIERDO FÍSICO
    if ([Mouse]::GetAsyncKeyState(1) -band 0x8000) {
        if ($now - $lLast -ge $lDelay) {
            [Mouse]::mouse_event(0x0002, 0, 0, 0, 0) # Presionar
            [Mouse]::mouse_event(0x0004, 0, 0, 0, 0) # Soltar
            $lLast = $now
        }
    }

    # DETECTAR CLIC DERECHO FÍSICO
    if ([Mouse]::GetAsyncKeyState(2) -band 0x8000) {
        if ($now - $rLast -ge $rDelay) {
            [Mouse]::mouse_event(0x0008, 0, 0, 0, 0) # Presionar
            [Mouse]::mouse_event(0x0010, 0, 0, 0, 0) # Soltar
            $rLast = $now
        }
    }
    
    # Pausa mínima para no quemar el procesador (1ms)
    Start-Sleep -Milliseconds 1
}
